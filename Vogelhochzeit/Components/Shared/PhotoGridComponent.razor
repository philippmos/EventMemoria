@using Vogelhochzeit.Models
@using Microsoft.AspNetCore.Components.Forms
@inject IDialogService DialogService

<MudPaper Class="pa-3" Elevation="0">
    <MudGrid Spacing="3">
        <PhotoUploadComponent OnPhotosUploaded="@OnPhotosUploaded" />
        
        @for (int i = 0; i < Photos.Count; i++)
        {
            var photoIndex = i;
            var photo = Photos[photoIndex];

            <MudItem xs="6" sm="4" md="3">

                    <MudImage Src="@photo.Url" 
                              Alt="Vogelhochzeit" 
                              Height="150" 
                              ObjectFit="ObjectFit.Cover"
                              Style="border-radius: 8px; width: 100%; cursor: pointer;"
                              @onclick="() => OpenGallery(photoIndex)" />

            </MudItem>
        }
    </MudGrid>
</MudPaper>

@code {
    [Parameter] public List<Photo> Photos { get; set; } = [];
    [Parameter] public EventCallback OnPhotosUploaded { get; set; }

    private async Task OpenGallery(int initialIndex)
    {
        var parameters = new DialogParameters<ImageGalleryDialog>
        {
            { x => x.Photos, Photos },
            { x => x.InitialIndex, initialIndex }
        };

        var options = new DialogOptions
        {
            MaxWidth = MaxWidth.ExtraExtraLarge,
            FullWidth = true,
            CloseOnEscapeKey = true,
            CloseButton = true,
            FullScreen = true
        };

        await DialogService.ShowAsync<ImageGalleryDialog>("", parameters, options);
    }
}
